# 顾客小程序-扫码后点餐-详述用例

- 用例名：扫码后点餐
- 范围：顾客点餐系统
- 级别：用户目标
- 主要参与者：顾客，商家店长
- 涉众及其关注点：
    - 顾客：通过扫码后，能够快速通过小程序点餐并付款
    - 商家店长：顾客点餐下单付款后，店长管理界面接到订单并处理订单
- 前置条件：
    - 商家已经上线菜品服务
    - 顾客扫码功能正常
    - 付款后订单一定被商家接收到
- 后置条件：
    - 顾客付款成功，商家收到订单
- 基本流程：

    1. 顾客打开微信，开启扫一扫，扫描桌子上的二维码，弹出点餐小程序。
    2. 顾客进入主菜单，浏览菜单，每个菜有菜名以及单价。点击想要吃的菜加入购物车。每个菜可以点击多次加入。
    3. 顾客点击购物车，显示购物车内的物品种类和数量以及单价，在下方显示总金额和下订单按钮。
    4. 点击下订单按钮，转去下订单页面，显示订单详情，应有总额和下单时间。
    5. 点击付款按钮，进行付款，付款成功生成订单传给后台。
    6. 后台收到订单，记录信息并将其传给对应的商家，返回信息给用户下单成功。
    7. 商家收到订单，接受订单，收到付款，后台相应更新订单状态。

- 替代流程：
    - 1a.顾客直接打开小程序
        1. 显示“请扫码”页面
        2. 顾客点击扫码按钮进行扫码
    - 2a.顾客进入推荐菜单
        1. 显示推荐菜品
        2. 顾客点击菜品加入购物车
    - 2b.顾客进入菜品搜索
        1. 顾客输入菜品名称搜索
        2. 顾客点击菜品加入购物车
    - 3a.购物车为空
        1. 显示字段提示用户购物车为空，请添加菜品
        2. 下订单按钮灭活
        3. 点击返回按钮返回主菜单
    - 5-6a.付款后顾客未收到下单成功信息
        1. 等待2秒后重发信息给后端，提示后端重发成功信息。
        2. 用户收到成功信息。(假定失败次数最后一次)
    - 7a.商家没有收到订单
        1. 轮询后端，获取最新订单列表详情
- 发生频率：非常频繁
- 特殊需求：
    - 订单应在付款后才正式创建并传给后台
- 未解决问题：
    - 轮询的机制
    - 扫码的具体细节